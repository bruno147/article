\section{Experimental Results} \label{sec:Experiments}

	A veil was put over the Five-state FSM from the very beginning of the experimentation phase, which was its great dependency towards the transition function. Early superficial evaluations of the performance of this first model indicated an overcharge concerning this function, which was verified by considerable changes in behaviour derived from adjustments in its parameters. For that reason, a second model with less states - the Three-state FSM - was designed regarding this characteristic and releasing part of the performance burden from the transition function, and the results from the comparison of these architectures are described and analyzed in the succeeding subsections.

\subsection{Methodology} \label{subsec:Methodology}

	Once the models - and which of their parameters required tuning - had been defined, the genetic algorithm was applied to each approach separately, in order to adjust their configurations for superior and competitive status. At the same time, the goal was to find general and versatile controllers with good results for any track and specific ones that were fittest to race in various tracks: road, dirt and oval alike. Therefore, due to the differences observed in the parameters of controllers evolved on dirt and road tracks, the evolution process took place separately for those two kinds of environments, which produced two contrasting sets of enhanced values for each model.
	
	The \emph{metric} chosen to evaluate the generated controllers was the combined sum of the distance raced by the car alone in the first 10 000 game cycles - also called \emph{game tics} - in a list of mixed tracks, it is the tick's number the qualifying at SCRC last. This value will henceforth be called the \emph{fitness} of the controller, as it was used to determine whether he would remain in the evolution process.
	
	The experiments concerning Oval Tracks would repeatedly provide inconclusive results, so they were neglected in this evaluation process. Thus, in order to find the best set of parameters for a general track, the two finite-state states were evolved in three different sets of tracks, one with 4 Dirt Tracks, one with 4 Road Tracks and another with the 4 of each type. The evolution process for each set of tracks consisted on 600 generations of 30 individuals and culminated in one controller; in other words, at the end of the experiments, there were six evolved controllers, one specific for Road Tracks for each model, one specific for Dirt Tracks for each model, and also one evolved in a mixed manner for each model. Additionally, as the \emph{Stuck State} is only triggered in very specific situations, it was not evolved with the controller and its parameters were hand tuned.
	
	Pursuing an unbiased choice of parameters, the Online Learning module described in Subsection~\ref{subsec:FSM3} was turned off during the evolution progress as it seizes the responsibility for the behaviour of the car for itself during the race and could interfere with natural selection. The validation then occurred through testing the six produced pilots in a predefined set of tracks different from those in which they were evolved, avoiding the evidence of too track-limited parameters. On behalf of comparison, the results from the AUTOPIA controller were incorporated in the analysis, since it can be considered the State of the Art, displaying one of the best performances for the SCR Championship, and should provide satisfactory basis for appraisal.

	The four Road Tracks used in the evolution process were chosen from the TORCS standard track set, which are \emph{Spring}, the longest track available on TORCS with more curves than any other track, \emph{Wheel 2}, the most difficult track with sharp and hard curves, \emph{E-Track 3}, a fast track with turns that put to test the dexterity of the controller, and \emph{Forza}, a track considered to be raced fast and whose curve pattern is usually found in others tracks. Also four Dirt Tracks were selected to be used in evolution, which were \emph{Dirt2}, \emph{Mixed1}, \emph{Mixed2}, \emph{Dirt6}. \emph{Dirt2} is a difficult track with close curves, while \emph{Mixed1} is an easy one with few curves, also, \emph{Mixed2} has many turns with medium difficulty, and \emph{Dirt6} present sections where the car drive out the track.
	
	Once the evolution process was finished, the six resultant controllers were tested in the evaluation set of tracks, different from those where they were evolved. Three Road Tracks were picked to evaluate the controllers, they are also available on TORCS and were used both in the competitions of 2008 and to evaluate the \emph{AUTOPIA} controller~\cite{AUTOPIA2009}. \emph{Street-1} and \emph{D-Speedway} were used at the \emph{IEEE World Congress on Computational Intelligence}; and \emph{CG Speedway 1} was used at the \emph{Computational Intelligence and Games Symposium - CIG}. This set also contained three Dirt Tracks, which were \emph{Dirt1}, \emph{Dirt3}, \emph{Dirt4}. \emph{Dirt1} has smooth curves and allows the controller to perform in high speed, while \emph{Dirt3} is an easy one with few curves, also, \emph{Dirt4} has many turns with medium difficulty and is the longest Dirt Track available.
	  
	
\subsection{Results} \label{subsec:Results}
	
	It is important to mention that before each result displayed in that section a warm-up stage was held for 5 laps in each track.
	
	The controllers were submitted to a set of evaluation races and the distances they covered in 10 000 game tics inside each of those races were joined in Table~\ref{tbl:dist covered}. This table also displays how the evolved controllers performed in comparison to the AUTOPIA controller.
	
	In order to have a more in-depth comparison, Table~\ref{tbl:time raced} was assembled to display the time elapsed during 10 laps for each of the previous tracks tested. The \textit{Berniw Hist4} bot provided by the TORCS distribution was also used in this test phase even though it uses a different car from those allowed in the SCRC~\cite{2009} and has a low performance compared to the others bots provided. AUTOPIA also uses this bot for comparison~\cite{AUTOPIA}.
	
	\begin{table*}[t]
	\renewcommand{\arraystretch}{1.3}
	\caption{Distance covered in meters racing alone for 10 000 game tics}
	\label{tbl:dist covered}
	\centering
	\begin{tabular}{c||c||c||c||c||c||c}
	\hline
	\bfseries Driver & \bfseries Street-1 & \bfseries D-speedway & \bfseries CG-speedway & \bfseries Dirt-1 & \bfseries Dirt-3 & \bfseries Dirt-4 \\ 
	\hline	
	\hline FSM3(road) & \textbf{7925.6} & 13196.5 & 8745.49 & 3978.01 & 3451.26 & 6757.83 \\
	\hline FSM3(dirt) & 2149.77	& 2450.84 & 1951.93	& 3525.84 & 4905.58 & 5590.78 \\
	\hline FSM3(mixed) & 7219.28 & 12772.4 & 8126.12 & \textbf{4386.64} & \textbf{5481.15} & \textbf{6939.83} \\
	\hline FSM5(road) & 3822.76 & 3427.11 & 4114.66	& 2145.49 &	2205.97 & 3260.19 \\
	\hline FSM5(dirt) & 1267.83 & 2936.82 &	4114.66 & 1072.92 &	2205.82 & 3260.33 \\
	\hline FSM5(mixed) & 3822.99 & 3427.06 & 4114.8 & 2145.75 &	2205.83 & 3260.31 \\
	\hline AUTOPIA & 7091.8 & \textbf{15612.3} & \textbf{8970.4} & * & * & * \\
	\hline 
	\end{tabular} 
	\end{table*}

	
	\begin{table*}[t]
	\renewcommand{\arraystretch}{1.3}
	\caption{Time elapsed in seconds racing alone for 10 laps}
	\label{tbl:time raced}
	\centering
	\begin{tabular}{c||c||c||c||c||c||c}
	\hline
	\bfseries Driver & \bfseries Street-1 & \bfseries D-speedway & \bfseries CG-speedway & \bfseries Dirt-1 & \bfseries Dirt-3 & \bfseries Dirt-4 \\ 
	\hline
		\hline FSM3(road) & \textbf{1086.3} & 607.4 & \textbf{495.0} & \textdagger & 1150.1 & 1756.4 \\
	\hline FSM3(dirt) & \textdagger & 840.0 & 1274.8 & 597.3 & 1089.4 & 1307.5 \\
	\hline FSM3(mixed) & 1216.50 & \textbf{572.60} & 613.77& 530.0 & 842.9 & 1005.9 \\
	\hline FSM5(road) & \textdagger & \textdagger & 816.6 & \textdagger & \textdagger & \textdagger \\
	\hline FSM5(dirt) & \textdagger & \textdagger & \textdagger & \textdagger &	\textdagger & \textdagger \\
	\hline FSM5(mixed) & \textdagger & \textdagger & \textdagger & \textdagger & \textdagger & \textdagger \\
	\hline Berniw Hist4 Bot & 1143.77 & 656.24 & 605.76 & 460.95 & 872.97 & 1127.45 \\
	\hline AUTOPIA & * & * & * & \textbf{339.3} & \textbf{742.4} & \textbf{796.5} \\
	\hline 
	\end{tabular} 
	\end{table*}
	
	It is important to mention that the bots have a full view of the track format and do not use the sensors provided by SCR. Instead, they have directly access to all the information necessary to race, which gives them some advantage over the controllers developed for the TORCS environment, such as the ones described in this paper, which receive only the information that comes from sensors and in addition have to interpret them in order to abstract how the track really is. 
	
\subsection{Analysis} \label{subsec:Analysis}
	
	The best pilots from each race evaluated by Tables~\ref{tbl:dist covered} and~\ref{tbl:time raced} were highlighted in bold. Both sets of experimental results shown at these tables were selected in order to match previous tests performed by the AUTOPIA controller. In 2009, the authors of AUTOPIA~\cite{AUTOPIA2009} evaluated it through racing for a predefined time period and computing the total distance reached, and these results were incorporated in Table~\ref{tbl:dist covered} for comparison. Differently, in 2012, this controller~\cite{AUTOPIA} was assessed by racing alone during 10 laps and calculating the time elapsed to do so, and these results were also incorporated in the evaluation process of this paper and are displayed in Table~\ref{tbl:time raced}. The tracks that are not present in either of the tests executed by AUTOPIA were validated only between the approaches proposed by this paper, which was informed in Tables~\ref{tbl:dist covered} and~\ref{tbl:time raced} through the ``*'' symbol, meaning that AUTOPIA had no results for that race in particular.
	
	For a wider analysis not only the numeric results were taken into account in this section but also observations made in the graphic mode provided by the TORCS distribution.
\subsubsection{Comparing the Controllers Proposed} \label{subsubsec:CompControllers}
	
	The overall comparison between the two approaches presented favored the Three-State FSM, on account of the considerably superior results it produced in all the tracks tested. The Five-State FSM presents a very complex transition function that takes into account the variance of the sensorial input to decide if the car is in a straight line, approaching a turn or in a turn. On the other hand, the Three-State FSM has only a single state for handling normal driving situations and it is very easy to say if the controller is inside or outside the track only by checking the track sensor. This contrast in behavior is then interpreted to be the reason of the overwhelming difference in performance, the complexity of the transition function, which supports the initial hypothesis of the evaluation. Due to this attribute, the Five-State FSM undergoes a lot of damage in its car, which can be noted in Table~\ref{tbl:time raced} where all the ``\textdagger'' symbols represent individuals that did not finish the race for the reason of reaching the maximum damage permitted.
	
	Because the Three-State FSM demonstrated better results than the other approach proposed, it was elected to be subject of analysis on the evaluation process. As expected, the controller evolved only on Road Tracks was the fastest one. These tracks provide an environment susceptible to high speeds, since its curves are smoother and the friction experienced by the car is higher than the ones from Dirt Tracks. These factors, when combined, allow the controller to race without having to steer too abruptly and to brake without losing control while racing in Road Tracks. Consequently, as the friction increases, steering becomes more accurate in road tracks, practically eliminating critical skidding. Therefore, the result from this end of the evolution process was an aggressive driver with high base-speed.
	
	Dirt Tracks provide a more difficult environment for the pilot to fit in. Sudden braking in tracks of this type often results in unwanted behavior, skidding is noticeably more common then. The driver evolved in this end of the evolution process tends to drive in a low speed so it can keep itself inside the boundaries of the track. Speed driving results in higher damage outcomes and even in the total loss of the car in critical situations. The result obtained was a very careful driver with a low base-speed, and an early brake policy - the car starting to brake far before the turn. This passive driving pattern obtained the smallest distance covered both for the Three-State and the Five-State FSMs.
	
	The driver evolved in a mixed set of tracks combines characteristics from both of them. It drives in a reasonable speed comparing to the first one, but also has the preventive brake policy from the second one. This last end of the evolution process achieved better results than the dirt-evolved behavior in all the tracks tested and outperformed the road-evolved one in every single dirt track. From this information gathered, it was inferred that the controller evolved in mixed tracks tries to reach higher speeds even though this means leaving the track in some turns, mostly because the time spent trying to get back to the racing lane is compensated by the speed of the car. The aggressive behavior inherited from the road-evolved end of the evolution makes this latest controller receive ample damage when leaving the track, and also causes it to hit walls, which resulted in the premature ending of some of the tested races, due to reaching the maximum acceptable damage.
	
\subsubsection{Comparing the Three-State FSM to AUTOPIA} \label{subsubsec:CompAUTOPIA}

	Once the Three-State FSM was demonstrated to be more suitable to competitive environments due to its superior performance regarding the Five-State FSM, it was compared to the renowned controller AUTOPIA. Using the distance covered after racing alone in Road Tracks for 10 000 game tics as metric, the Three-State FSMs evolved in Road Tracks and in mixed tracks were able to overcome AUTOPIA in 1 of the 3 tracks tested, as displayed in the bold values in Table~\ref{tbl:dist covered}. The road-evolved Three-State FSM was the controller that got closer to this State of the Art approach using the ``distance raced'', which comes to endorse the assumption of it being a competitive proposal.
	
	However, while racing alone for 10 laps and computing the time elapsed as metric, AUTOPIA outperformed every controller proposed, just as can be seen in Table~\ref{tbl:time raced}. Even though the Three-State controller with Road evolved parameters outperformed AUTOPIA in the first 10 000 tics it was not capable of maintaining the advantage in longer races. As the road evolved pilot presents a more aggressive behavior even though it means taking more damage it has a gain in performance for the early stages of the race. Although when racing for more than a couple laps the controller becomes more careful after each lap reducing it speed to maintain itself inside the track.
	
	The online learning module plays a crucial role in the overall controller's performance as it prevents unwanted situations to repeat, for example leaving the track. Although this strong dependence might result in performance loss as the controller will gradually reduces it speed after each lap in those points where it leaves the track. More accurate actuators control may reduce the dependence of this module and therefore improves performance.
	
	These results can be used to infer that the Five-State and the Three-State FSMs have a great deal of improvement to achieve when it comes to endurance. The Five-State FSM received total loss and did not complete almost every test performed, ending only one race using this metric. The Three-State FSM, on the other hand, completed practically all the tracks, but did not surpass AUTOPIA in either of them. In order to enhance the endurance feature in the controllers proposed, more robust behavior concerning situations in which the car might crash must be taken into account.	
	
	
